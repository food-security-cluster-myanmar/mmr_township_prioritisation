"0","# main township-level dataset
fs_pin <- read_excel(""./data/hpc_pin.xlsx"") %>%   
  left_join(conflict_score %>% 
              select(admin3_pcode, battles, explosions_remote_violence, 
                     protests_and_riots, strategic_developments,
                     violence_against_civilians, conflict_score, fatalities),
            by = ""admin3_pcode"") %>% 
  left_join(vulmmr %>% select(admin3_pcode = township_pcode, 
                              admin2_pcode = district_pcode, 
                              total_population_2015 = total_pop_both_sexes,
                              area_sown_acres = all_area_sowed_mali, 
                              population_density, vulnerability_band,
                              old_conflict_score = conflict_index_a_average_of_percent_of_totals,
                              old_conflict_env = conflict_index_b_average_of_envelopes,
                              approximate_vulnerable_population),
            by = ""admin3_pcode"") %>% 
  left_join(floods_storm_surge %>% 
              select(admin3_pcode, flood_prob, flood_count),
            by = ""admin3_pcode"") %>% 
  mutate(fs_pin = ifelse(fs_pin > population_2021_proj, population_2021_proj, fs_pin)) %>% 
  replace_na(list(conflict_score = 0, flood_prob = 0)) %>% 
  mutate(band_text = case_when(
    vulnerability_band == 1 ~ ""1. Extreme outliers, underdevelopment and conflict"",
    vulnerability_band == 2 ~ ""2. Conflict-affected, poor human development"",
    vulnerability_band == 3 ~ ""3. Hubs in conflict-affected areas"",
    vulnerability_band == 4 ~ ""4. Very low access to services and infrastructure"",
    vulnerability_band == 5 ~ ""5. Agricultural areas with high profits"",
    vulnerability_band == 6 ~ ""6. Secondary cities/towns in agricultural areas"",
    vulnerability_band == 7 ~ ""7. Up-and-coming peri-urban and urban areas"",
    vulnerability_band == 8 ~ ""8. Affluent, urban core"")) %>% 
  left_join(vul_share$data %>%  select(-conflict_score), by = ""admin3_pcode"") %>%
  mutate(mdp_score_old = (avg_safe_sanitation_improved_drinking_water + average_good_roof_and_wall + 
           highest_education_at_least_middle_school_percent_14 + electricity_for_lighting_percent_15 + 
           id_card_with_id_total_percent_16 + female_literacy_percent_literate + 
           child_dependency_ratio_31 + unpaid_family_worker_percent) / 8) %>% 
  ungroup()
"
"2","Error in select(., admin3_pcode, flood_prob, flood_count) : 
  object 'floods_storm_surge' not found
"
